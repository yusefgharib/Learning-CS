type: edu
files:
- name: university.py
  visible: true
  text: |
    from collections import defaultdict

    max_students = int(input())
    math, physics, bio, chem, engineering, students = [], [], [], [], [], []
    with open('applicant_list_5.txt', 'r') as f:
        for line in f.readlines():
            student = line.split()
            name = student[0] + ' ' + student[1]
            # score2, score3 = 0, 0
            scores = [0, 0]
            for i in range(2):
                scores[i] = int(student[4]) if student[i + 7] == "Mathematics" \
                    else (int(student[2]) + int(student[4])) / 2 if student[i + 7] == 'Physics' \
                    else (int(student[3]) + int(student[2])) / 2 if student[i + 7] == 'Biotech' \
                    else int(student[3]) if student[i + 7] == 'Chemistry' \
                    else (int(student[5]) + int(student[4])) / 2
            students.append([name, scores[0], scores[1], student[7], student[8]])
            math.append([name, int(student[4])]) if student[6] == 'Mathematics' \
                else physics.append([name, (int(student[2]) + int(student[4])) / 2]) if student[6] == 'Physics' \
                else bio.append([name, (int(student[3]) + int(student[2])) / 2]) if student[6] == 'Biotech' \
                else chem.append([name, int(student[3])]) if student[6] == 'Chemistry' \
                else engineering.append([name, (int(student[5]) + int(student[4])) / 2])
    applications = {"Biotech": bio, "Chemistry": chem, "Engineering": engineering, "Mathematics": math, "Physics": physics}
    for key in applications:
        applications[key].sort(key=lambda x: (-x[1], x[0]))
    accepted_students = defaultdict(list)
    for subject in applications:
        for i in range(max_students):
            if i >= len(applications[subject]):
                break
            accepted_students[subject].append([applications[subject][i][0], applications[subject][i][1]])
            for student in students:
                if student[0] == applications[subject][i][0]:
                    students.remove(student)
    for j in range(2):
        students.sort(key=lambda x: (-x[1 + j], x[0]))
        for key in accepted_students:
            if len(accepted_students[key]) < max_students:
                for i, name in enumerate(students):
                    if len(accepted_students[key]) == max_students:
                        break
                    if name[3 + j] == key:
                        accepted_students[key].append([name[0], name[1 + j]])
                        students[i] = ["0", 0, 0, "0", "0"]

    for key in dict(accepted_students):
        accepted_students[key] = sorted(accepted_students[key], key=lambda x: (-x[1], x[0]))
    for subject in accepted_students:
        with open(f"{subject.lower()}.txt", "w") as f:
            content = ''
            for student in accepted_students[subject]:
                content += f"{student[0]} {student[1]}\n"
            f.write(content)
  learner_created: false
- name: test/__init__.py
  visible: false
  learner_created: false
- name: tests.py
  visible: false
  text: |
    from hstest import StageTest, CheckResult, WrongAnswer, TestCase
    from test.application_list import application_list as application_list

    input_1 = ["5"]
    input_2 = ["23"]
    input_3 = ["10"]
    input_4 = ["15"]


    class TestAdmissionProcedure(StageTest):
        def generate(self):
            return [
                TestCase(stdin=input_1, attach=input_1, files={'applicants.txt': application_list}),
                TestCase(stdin=input_2, attach=input_2, files={'applicants.txt': application_list}),
                TestCase(stdin=input_3, attach=input_3, files={'applicants.txt': application_list}),
                TestCase(stdin=input_4, attach=input_4, files={'applicants.txt': application_list})
            ]

        @staticmethod
        def sort_by_priority(applicants, priority_n, departments_names, departments_lists, max_students, exams):

            def mean(numbers):
                return sum(numbers) / len(numbers)

            accepted_students = []
            for n, dep in enumerate(departments_names):
                dep_list = departments_lists[n]
                exam_numbers = exams[n]
                if len(dep_list) == max_students:
                    continue
                students_needed = max_students - len(dep_list)
                dep_applicants = []
                for applicant in applicants:
                    if applicant[-1][priority_n] != dep:
                        continue
                    mean_exam_score = mean([applicant[exam_n + 1] for exam_n in exam_numbers])
                    best_score = float(max([mean_exam_score, applicant[-2]]))
                    dep_applicants.append([applicant[0], best_score])

                dep_applicants = sorted(dep_applicants, key=lambda x: (-x[1], x[0]))[:students_needed]
                departments_lists[n].extend(dep_applicants)
                accepted_students.extend([appl[0] for appl in dep_applicants])
            applicants = [applicant for applicant in applicants if applicant[0] not in accepted_students]
            return applicants, departments_lists

        @staticmethod
        def get_admission_lists(max_students):
            applicants = application_list.strip().split('\n')
            departments = {'Mathematics': [2], 'Physics': [0, 2], 'Biotech': [1, 0], 'Chemistry': [1],
                           'Engineering': [3, 2]}
            exams = [departments[dep] for dep in sorted(departments)]
            departments = sorted(departments)
            applicants_data = []
            for line in applicants:
                line = line.split()
                line = [line[0] + ' ' + line[1]] + [float(element) for element in line[2:-3]] + [line[-3:]]
                applicants_data.append(line)
            departments_lists = [[] for _ in departments]
            for i in range(len(applicants_data[-1][-1])):
                applicants_data, departments_lists = TestAdmissionProcedure.sort_by_priority(applicants_data,
                                                                                             i, departments,
                                                                                             departments_lists,
                                                                                             max_students, exams)
            departments_lists = [[' '.join([str(el) for el in applicant])
                                  for applicant in sorted(dep, key=lambda x: (-x[1], x[0]))]
                                 for dep in departments_lists]
            return departments, departments_lists

        def check(self, reply: str, attach: list):
            n = int(attach[0])
            department_names, admission_lists = self.get_admission_lists(n)
            for i, department_name in enumerate(department_names):
                filename = department_name.lower() + ".txt"
                try:
                    with open(filename, "r", encoding="utf-8") as fh:
                        output_applicants = fh.read()
                except FileNotFoundError:
                    raise WrongAnswer("The file {0} is not found.\n"
                                      "Please make sure that you output results to files\n"
                                      "and specify the correct paths for them.".format(filename))

                if not output_applicants:
                    raise WrongAnswer("The file for the {0} department is empty.".format(department_name))
                output_applicants = output_applicants.strip().split('\n')
                output_applicants = [line for line in output_applicants if line.strip()]
                correct_applicants = admission_lists[i]
                if len(correct_applicants) != len(output_applicants):
                    raise WrongAnswer("The file for the {0} department is expected to contain {1} line(s).\n"
                                      "However, {2} lines are found.".format(department_name, len(correct_applicants),
                                                                             len(output_applicants)))

                for j, applicant in enumerate(correct_applicants):
                    applicant_name, applicant_surname, score = applicant.split()
                    applicant_name = "{0} {1}".format(applicant_name, applicant_surname)
                    score = round(float(score), 2)
                    output_applicant = output_applicants[j].strip().split(' ')
                    if len(output_applicant) != 3:
                        raise WrongAnswer("Line {0} for the {1} department "
                                          "does not seem to contain three elements: first name, last name and score.\n"
                                          "Make sure you separate them "
                                          "with one whitespace character.".format(j + 1,
                                                                                  department_name))
                    output_applicant_name = "{0} {1}".format(output_applicant[0], output_applicant[1])
                    try:
                        output_score = round(float(output_applicant[-1]), 2)
                    except ValueError:
                        raise WrongAnswer("The second element in line {0} for the {1} department\n"
                                          "does not seem to be a number: \"{2}\". \n"
                                          "Make sure you format the output "
                                          "as stated in the example.".format(j + 1,
                                                                             department_name,
                                                                             output_applicant[1]))
                    if applicant_name.lower().strip() not in output_applicant_name.lower():
                        raise WrongAnswer("The first element in line {0} for the {1} department\n"
                                          "does not seem to contain the correct name of the student ({2}).\n"
                                          "Instead, it is equal to \"{3}\"".format(j + 1, department_name,
                                                                                   applicant_name,
                                                                                   output_applicant_name))

                    if score != output_score:
                        raise WrongAnswer("The second element in line {0} for the {1} department\n"
                                          "does not seem to contain the correct score of the student ({2}).\n"
                                          "Instead, it is equal to \"{3}\"".format(j + 1, department_name,
                                                                                   score,
                                                                                   output_score))

            return CheckResult.correct()


    if __name__ == '__main__':
        TestAdmissionProcedure().run_tests()
  learner_created: false
- name: test/application_list.py
  visible: false
  text: |-
    application_list = """Jermine Brunton 84 81 73 92 48 Physics Engineering Mathematics
    Justo Mirfin 71 77 61 60 41 Engineering Biotech Chemistry
    Uzma Naysmythe 60 94 75 71 80 Chemistry Engineering Mathematics
    Koury Wingo 71 81 81 83 59 Engineering Biotech Mathematics
    Kentrell Hillhouse 40 69 42 58 20 Mathematics Engineering Biotech
    Trica Macalpine 75 80 96 88 66 Engineering Mathematics Biotech
    Sang Muldoon 84 92 80 60 79 Physics Mathematics Engineering
    Laney Braithwaite 90 90 90 72 94 Physics Chemistry Mathematics
    Spring Burridge 71 84 98 71 50 Mathematics Chemistry Engineering
    Delta Fanny 84 85 83 86 49 Chemistry Physics Mathematics
    Elen Ashbury 54 76 88 62 60 Mathematics Chemistry Biotech
    Ruthanne Scaife 75 73 84 97 82 Engineering Biotech Mathematics
    Jaemi Hallets 81 71 73 86 78 Physics Engineering Mathematics
    Artavious Fay 71 77 61 60 61 Engineering Biotech Chemistry
    Franki Dinnis 60 94 75 71 80 Chemistry Biotech Mathematics
    Marlynn Favell 71 81 81 93 79 Engineering Biotech Mathematics
    Sameera Procter-Baines 70 59 72 68 80 Mathematics Engineering Biotech
    Shantale Tompkins 75 80 96 88 66 Engineering Mathematics Biotech
    Cornellius Turney 84 92 80 60 79 Physics Mathematics Engineering
    Blia Sagar 90 81 80 72 94 Physics Chemistry Biotech
    Wynn Crampton 71 84 98 71 50 Mathematics Chemistry Engineering
    Linda Risley 85 85 83 86 49 Chemistry Physics Mathematics
    Divina Butterworth 54 76 88 62 70 Mathematics Chemistry Biotech
    Meshell Otway-Ruthven 75 73 84 97 94 Engineering Biotech Mathematics
    Ammon Janssen 84 81 73 92 48 Physics Engineering Mathematics
    Maila Greg 71 77 61 60 49 Mathematics Biotech Chemistry
    Madiha Milligan 60 94 79 71 80 Physics Engineering Chemistry
    Humphrey Spakeman 71 81 81 83 89 Chemistry Biotech Mathematics
    Marygrace Wheelton 60 77 42 55 60 Mathematics Engineering Biotech
    Takyra Sieminski 74 80 96 92 66 Engineering Mathematics Physics
    Jathan Birley 84 92 80 60 79 Physics Mathematics Engineering
    Tawnia Alcock 81 80 90 72 91 Biotech Chemistry Physics
    Quinisha Clarkson 71 84 98 71 80 Mathematics Chemistry Engineering
    Dashanna Herron 80 85 73 86 89 Physics Chemistry Mathematics
    Verlon Mcconnell 84 61 88 62 60 Mathematics Chemistry Biotech
    Tawsha Rodgers 78 71 84 97 82 Engineering Biotech Mathematics
    Derick Whatley 81 91 73 80 78 Physics Engineering Mathematics
    Tisheena Mckenney 76 57 61 90 61 Engineering Physics Biotech
    Kyona Catrol 60 94 75 77 40 Chemistry Biotech Mathematics
    Jamarl Delap 92 81 85 93 79 Engineering Biotech Mathematics
    Tulio Carloss 66 59 82 64 60 Mathematics Engineering Physics
    Kaylie Lanthis 75 80 96 88 66 Engineering Mathematics Biotech
    Martha Hatchard 84 92 80 60 79 Physics Mathematics Engineering
    Genee Mccrae 90 81 80 72 94 Biotech Chemistry Physics
    Luna Pheobe 71 84 98 71 50 Chemistry Mathematics Engineering
    Savvas Hjellstrom 55 85 41 66 45 Chemistry Biotech Mathematics
    Mehul Bull 94 76 88 61 70 Mathematics Physics Biotech
    Kennedy Barrett 77 93 84 87 94 Chemistry Biotech Mathematics
    Marquita Mcrae 84 81 73 92 48 Physics Engineering Biotech
    Natha Keefe 71 67 53 60 31 Engineering Biotech Chemistry
    Crescentia Dow 86 94 85 51 80 Chemistry Physics Mathematics
    Randon Bradhust 72 88 85 83 59 Biotech Engineering Chemistry
    Dashawn Bosley 80 79 82 61 40 Mathematics Chemistry Biotech
    Nicolasa Sumpter 75 82 96 81 38 Engineering Mathematics Biotech
    Cressie Gillespie 85 92 82 70 59 Physics Mathematics Engineering
    Tawny Crockett 71 90 80 72 44 Chemistry Biotech Physics
    Kennon Inverarity 71 84 98 71 72 Mathematics Engineering Chemistry
    Halima Brydone 77 85 82 86 50 Chemistry Physics Mathematics
    Esther Bratby 55 76 88 62 30 Mathematics Chemistry Biotech
    Lorry Bunger 75 73 84 97 22 Engineering Biotech Physics
    Fatemah Desavigny 81 71 73 86 78 Physics Mathematics Engineering
    Marti Mclaws 71 71 61 60 41 Engineering Chemistry Biotech
    Estephanie Phelps 80 95 45 71 80 Chemistry Physics Mathematics
    Tommi Peerless 72 81 81 92 75 Engineering Physics Mathematics
    Cynthia Hermitton 70 59 62 88 80 Engineering Biotech Chemistry
    Cheyla Hankinson 75 80 86 88 36 Engineering Mathematics Biotech
    Giovanna Keel 84 71 76 80 79 Physics Mathematics Engineering
    Narissa Worthington 52 71 80 73 81 Biotech Chemistry Mathematics
    Aundria Guthrie 61 81 94 71 21 Mathematics Chemistry Engineering
    Teneil Maclean 85 63 84 45 69 Mathematics Physics Chemistry
    Shealynn Melville 74 76 88 62 70 Mathematics Chemistry Physics
    Darrah Smyth 75 73 84 97 94 Physics Biotech Engineering
    Elroy Leyte 84 81 73 92 48 Engineering Physics Mathematics
    Jessye Allum 71 77 61 60 49 Mathematics Biotech Chemistry
    Pearl Pullins 60 94 79 71 33 Chemistry Engineering Mathematics
    Brittania Denny 90 84 70 61 72 Chemistry Physics Mathematics
    Mendy Macmillan 61 81 81 70 51 Biotech Engineering Mathematics
    Ramina Ogilvie 80 65 70 68 29 Mathematics Engineering Biotech
    Ronel Cowan 75 80 96 88 66 Engineering Mathematics Biotech
    Stacey Revill 84 92 84 70 51 Chemistry Physics Mathematics
    Mir Ashley 71 84 98 71 83 Mathematics Physics Chemistry
    Ayeshia Jackman 80 85 73 86 89 Chemistry Physics Mathematics
    Jordann Rives 84 61 88 62 60 Mathematics Chemistry Biotech
    Katrine Proby 78 71 84 90 42 Engineering Biotech Mathematics
    Jermain Stobbs 81 91 73 80 78 Physics Engineering Mathematics
    Sharief Macallister 76 57 61 99 61 Engineering Physics Biotech
    Shannette Cowie 60 94 75 77 20 Chemistry Biotech Mathematics
    Melena Hearn 92 81 85 93 79 Engineering Biotech Mathematics
    Moraima Kendell 66 59 82 64 60 Mathematics Engineering Physics
    Amira Giddings 75 80 96 78 66 Engineering Mathematics Physics
    Tyrone Fern 64 92 80 52 79 Physics Mathematics Engineering
    Joaquin Mytton 54 76 88 62 60 Mathematics Chemistry Biotech
    Ehab Cocciardi 75 73 84 97 82 Engineering Biotech Mathematics
    Tamkia Fish 81 71 73 86 78 Physics Engineering Mathematics
    Deniz Blanchard 71 77 61 60 61 Engineering Biotech Chemistry
    Mira Riley 60 94 75 71 80 Chemistry Biotech Mathematics
    Loura Macansh 71 81 81 93 79 Engineering Physics Mathematics
    Nastassja Trustram 60 49 82 68 70 Mathematics Engineering Physics"""
  learner_created: false
- name: applicant_list_7.txt
  visible: true
  learner_created: true
- name: physics.txt
  visible: true
  learner_created: true
- name: biotech.txt
  visible: true
  learner_created: true
- name: mathematics.txt
  visible: true
  learner_created: true
- name: chemistry.txt
  visible: true
  learner_created: true
- name: engineering.txt
  visible: true
  learner_created: true
feedback_link: https://hyperskill.org/learn/step/12324#comment
status: Solved
feedback:
  message: Well done! You've finished the project. Select a new project on <a href="https://hyperskill.org/projects">JetBrains
    Academy</a> to continue learning.
  time: Tue, 06 Sep 2022 02:44:35 UTC
record: 6
